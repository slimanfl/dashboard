import{a4 as E,a5 as $,a as T,o as u,f as C,e as a,b as e,p as P,_ as k,H as v,s as m,t as p,m as h,I as b,c as B,F as w,h as M,x as S,d,v as U,a6 as L,a7 as q,r as D}from"./index-Bl39KaJY.js";import{P as F}from"./vue3-perfect-scrollbar.esm-BqAYcTcE.js";import{V as j,a as I}from"./VChip-D44p8HVd.js";import{V as O}from"./VBadge-Cilfis3Q.js";import{V as H}from"./VMenu-Bkd-BkYz.js";import{V as G,a as J,b as K}from"./VCard-D-OnHNzL.js";import{V as Q}from"./VTooltip-D4AVQ9Z2.js";import{V}from"./VDivider-BNpVOQPa.js";import{V as W,a as A,b as X}from"./VList-CttHFKmN.js";import{V as Y}from"./VSpacer-ByWVOqla.js";import{V as Z}from"./VCardText-qfqDA9bi.js";import"./VAvatar-BmL7VrqC.js";import"./VImg-BSkQo23z.js";import"./VOverlay-B5GyYh6t.js";/* empty css              */const ee={class:"d-flex align-start gap-3"},te={class:"text-sm font-weight-medium mb-1"},ae={class:"text-body-2 mb-2",style:{"letter-spacing":"0.4px !important","line-height":"18px"}},oe={class:"text-sm text-disabled mb-0",style:{"letter-spacing":"0.4px !important","line-height":"18px"}},se={class:"d-flex flex-column align-end"},ie={__name:"Notifications",props:{notifications:{type:Array,required:!0},badgeProps:{type:Object,required:!1,default:void 0},location:{type:null,required:!1,default:"bottom end"}},emits:["read","unread","remove","click:notification"],setup(y,{emit:r}){const _=E("accessToken").value,i=y,c=r,f=$(()=>i.notifications.some(t=>t.status==="read")),g=()=>{const t=i.notifications.map(l=>l.id);f.value?c("read",t):c("unread",t)},x=$(()=>i.notifications.filter(t=>t.status==="unread").length+1),s=(t,l)=>{t=="unread"?c("unread",[l]):c("read",[l])},n=()=>{I.patch("https://booking-back-sand.vercel.app/notifications",{},{headers:{Authorization:`Bearer ${_}`}})};return(t,l)=>{const N=T("IconBtn");return u(),C(N,{id:"notification-btn"},{default:a(()=>[e(O,P(i.badgeProps,{"model-value":i.notifications.some(o=>o.status==="unread"),color:"error",dot:"","offset-x":"2","offset-y":"3"}),{default:a(()=>[e(k,{size:"24",icon:"tabler-bell"})]),_:1},16,["model-value"]),e(H,{activator:"parent",width:"380px",location:i.location,offset:"12px","close-on-content-click":!1},{default:a(()=>[e(G,{class:"d-flex flex-column"},{default:a(()=>[e(J,{class:"notification-section"},{append:a(()=>[v(e(j,{size:"small",color:"primary",class:"me-2"},{default:a(()=>[m(p(h(x))+" New ",1)]),_:1},512),[[b,i.notifications.some(o=>o.status==="unread")]]),v(e(N,{size:"34",onClick:g},{default:a(()=>[e(k,{size:"20",color:"high-emphasis",icon:h(f)?"tabler-mail-opened":"tabler-mail"},null,8,["icon"]),e(Q,{activator:"parent",location:"start"},{default:a(()=>[m(p(h(f)?"Mark all as read":"Mark all as unread"),1)]),_:1})]),_:1},512),[[b,i.notifications.length]])]),default:a(()=>[e(K,{class:"text-h6"},{default:a(()=>[m(" Notifications ")]),_:1})]),_:1}),e(V),e(h(F),{options:{wheelPropagation:!1},style:{"max-block-size":"23.75rem"}},{default:a(()=>[e(W,{class:"notification-list rounded-0 py-0"},{default:a(()=>[(u(!0),B(w,null,M(i.notifications,(o,R)=>(u(),B(w,{key:o.title},[R>0?(u(),C(V,{key:0})):S("",!0),e(A,{link:"",lines:"one","min-height":"66px",class:"list-item-hover-class",onClick:z=>t.$emit("click:notification",o)},{default:a(()=>[d("div",ee,[d("div",null,[d("p",te,p(o.title),1),d("p",ae,p(o.message),1),d("p",oe,p(o.createdAt),1)]),e(Y),d("div",se,[e(k,{size:"10",icon:"tabler-circle-filled",color:o.status=="unraed"?"primary":"#a8aaae",class:U([`${o.status=="read"?"visible-in-hover":""}`,"mb-2"]),onClick:L(z=>s(o.status,o.id),["stop"])},null,8,["color","class","onClick"]),e(k,{size:"20",icon:"tabler-x",class:"visible-in-hover",onClick:z=>t.$emit("remove",o.id)},null,8,["onClick"])])])]),_:2},1032,["onClick"])],64))),128)),v(e(A,{class:"text-center text-medium-emphasis",style:{"block-size":"56px"}},{default:a(()=>[e(X,null,{default:a(()=>[m("No Notification Found!")]),_:1})]),_:1},512),[[b,!i.notifications.length]])]),_:1})]),_:1}),e(V),v(e(Z,{class:"pa-4"},{default:a(()=>[e(q,{block:"",size:"small",onClick:l[0]||(l[0]=o=>n())},{default:a(()=>[m(" View All Notifications ")]),_:1})]),_:1},512),[[b,i.notifications.length]])]),_:1})]),_:1},8,["location"])]),_:1})}}},xe={__name:"NavBarNotifications",setup(y){const r=D([]),_=E("accessToken").value;(async()=>{try{const n=await(await fetch("https://booking-back-sand.vercel.app/notifications",{headers:{Authorization:`Bearer ${_}`}})).json();r.value=n.data}catch(s){console.error("Error fetching service types:",s)}})();const c=s=>{r.value.forEach((n,t)=>{s===n.id&&r.value.splice(t,1)})},f=s=>{r.value.forEach(n=>{s.forEach(t=>{t===n.id&&(n.status="read")})})},g=s=>{r.value.forEach(n=>{s.forEach(t=>{t===n.id&&(n.status="unread")})})},x=s=>{console.log(s),I.patch(`https://booking-back-sand.vercel.app/notifications/${s._id}`,{},{headers:{Authorization:`Bearer ${_}`}})};return(s,n)=>{const t=ie;return u(),C(t,{notifications:h(r),onRemove:c,onRead:f,onUnread:g,"onClick:notification":x},null,8,["notifications"])}}};export{xe as default};
